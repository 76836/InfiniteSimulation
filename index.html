<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nothing playable yet...</title>
    <style>
        /* Previous styles remain the same until dialogue-box */
        :root {
            --primary: #00fff2;
            --accent: #ff00ff;
            --dark: #0a0a0f;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }

        body {
            background: var(--dark);
            color: white;
            min-height: 100vh;
        }

        #start-screen, #game-interface, .pause-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
        }

        #start-screen.active, #game-interface.active, .pause-menu.active {
            display: flex;
        }

        /* Start Screen */
        #start-screen {
            background: var(--dark);
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 1em;
        }

        /* Game Interface */
        #game-interface {
            flex-direction: column;
        }

        .scene {
            flex: 1;
            position: relative;
            background-position: center;
            background-size: cover;
        }

        .character {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            height: 80%;
            object-fit: contain;
        }

        .dialogue-box {
            background: rgba(0,0,0,0.8);
            padding: 1.5em;
            min-height: 150px;
            border-top: 1px solid var(--primary);
            position: relative;
        }

        .speaker {
            color: var(--primary);
            margin-bottom: 0.5em;
        }

        /* Continue indicator */
        .continue-indicator {
            position: absolute;
            bottom: 1em;
            right: 1em;
            width: 20px;
            height: 20px;
            border-right: 2px solid var(--primary);
            border-bottom: 2px solid var(--primary);
            transform: rotate(45deg);
            opacity: 0;
            animation: bounce 1s infinite;
        }

        .continue-indicator.active {
            opacity: 1;
        }

        @keyframes bounce {
            0%, 100% { transform: rotate(45deg) translate(0, 0); }
            50% { transform: rotate(45deg) translate(5px, 5px); }
        }

        .dialogue-controls {
            position: absolute;
            bottom: 1em;
            left: 1em;
            display: flex;
            gap: 1em;
        }

        /* Rest of the previous styles */
        .choices {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 1em;
            padding: 2em;
        }

        .choices.active {
            display: flex;
        }

        button {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 1em;
            min-width: 200px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:hover {
            background: var(--primary);
            color: var(--dark);
        }

        .pause-menu {
            background: rgba(0,0,0,0.9);
            justify-content: center;
            align-items: center;
            gap: 1em;
            z-index: 1000;
        }

        .pause-btn {
            position: fixed;
            top: 1em;
            right: 1em;
            z-index: 100;
            min-width: auto;
            width: 40px;
            height: 40px;
        }

        .control-btn {
            min-width: auto;
            width: auto;
            padding: 0.5em 1em;
        }

        @media (max-width: 768px) {
            .character { height: 60%; }
            button { min-width: 150px; }
        }
    </style>
</head>
<body>
    <div id="start-screen" class="active">
        <h1>Infinite Simulation</h1>
        <button onclick="startGame()">Start the demo.</button>
        <button onclick="alert('Nothing is here...');">Settings</button>
    </div>

    <div id="game-interface">
        <button class="pause-btn" onclick="togglePause()">menu</button>
        <div class="scene">
            <img class="character">
        </div>
        <div class="dialogue-box">
            <div class="speaker"></div>
            <div class="dialogue"></div>
            <div class="continue-indicator"></div>
            <div class="dialogue-controls">
                <button class="control-btn" onclick="toggleAuto()">Auto</button>
                <button class="control-btn" onclick="toggleSkip()">Skip</button>
            </div>
        </div>
        <div class="choices"></div>
    </div>

    <div class="pause-menu">
        <button onclick="togglePause()">Resume</button>
        <button onclick="returnToTitle()">Main Menu</button>
        <button onclick="quitGame()">Quit</button>
    </div>

    <script>
        // Game state management
        const gameState = {
            isTyping: false,
            currentScene: null,
            paused: false,
            auto: false,
            autoDelay: 2000, // Time to wait before auto-advancing (ms)
            skipMode: false
        };

        // Demo dialogue for testing
        const demoDialogue = [
            { speaker: "System", dialogue: "(Everything in this game is AI generated)" },
            { speaker: "System", dialogue: "Welcome to the infinite demo loop!" },
            { speaker: "System", dialogue: "This is a demonstration of the dialogue system." },
            { speaker: "System", dialogue: "You can click or tap to advance the text..." },
            { speaker: "System", dialogue: "Or use the Auto feature to watch it play automatically!" },
            { speaker: "System", dialogue: "In the real game, everything will be AI generated as you play..." },
            { speaker: "System", dialogue: "The AI will be prompted by the option you choose..." },
            { speaker: "System", dialogue: "So every playthrough will be different and original." },
        ];

        // Core game functions
        function startGame() {
            document.getElementById('start-screen').classList.remove('active');
            document.getElementById('game-interface').classList.add('active');
            runDemo();
        }

        // Demo loop
        async function runDemo() {
            while (true) {
                // Play through demo dialogue
                for (let dialogue of demoDialogue) {
                    await playScene({
                        background: '/api/placeholder/1920/1080',
                        character: '/api/placeholder/800/1200',
                        speaker: dialogue.speaker,
                        dialogue: dialogue.dialogue
                    });
                }
                
                // Present choices
                const choice = await playScene({
                    background: '/api/placeholder/1920/1080',
                    character: '/api/placeholder/800/1200',
                    speaker: "System",
                    dialogue: "What would you like to do?",
                    choices: ["(This demo seems like it's looping)", "So are my response options going to be AI generated?", "..."]
                });
                
                // Choice doesn't matter, we'll loop anyway
            }
        }

        function toggleAuto() {
            gameState.auto = !gameState.auto;
            document.querySelector('[onclick="toggleAuto"]').style.background = 
                gameState.auto ? 'var(--primary)' : 'transparent';
        }

        function toggleSkip() {
            gameState.skipMode = !gameState.skipMode;
            document.querySelector('[onclick="toggleSkip"]').style.background = 
                gameState.skipMode ? 'var(--primary)' : 'transparent';
        }

        // Scene management
        async function playScene(sceneData) {
            return new Promise((resolve) => {
                const scene = document.querySelector('.scene');
                const character = document.querySelector('.character');
                const indicator = document.querySelector('.continue-indicator');
                
                // Set scene elements
                scene.style.backgroundImage = `url(${sceneData.background})`;
                character.src = sceneData.character;
                document.querySelector('.speaker').textContent = sceneData.speaker;
                
                // Type dialogue
                typeDialogue(sceneData.dialogue, () => {
                    if (sceneData.choices) {
                        showChoices(sceneData.choices, resolve);
                    } else {
                        // Show continue indicator
                        indicator.classList.add('active');
                        
                        // Handle continuation
                        function continueScene() {
                            if (!gameState.isTyping) {
                                indicator.classList.remove('active');
                                document.removeEventListener('click', continueScene);
                                resolve();
                            }
                        }

                        document.addEventListener('click', continueScene);

                        // Auto-advance if enabled
                        if (gameState.auto && !sceneData.choices) {
                            setTimeout(() => {
                                if (!gameState.paused) continueScene();
                            }, gameState.autoDelay);
                        }
                    }
                });
            });
        }

        function typeDialogue(text, onComplete) {
            const dialogueElement = document.querySelector('.dialogue');
            const indicator = document.querySelector('.continue-indicator');
            gameState.isTyping = true;
            indicator.classList.remove('active');
            let index = 0;

            function type() {
                if (index < text.length && !gameState.skipMode) {
                    dialogueElement.textContent = text.substring(0, index + 1);
                    index++;
                    setTimeout(type, 30);
                } else {
                    // If skipping or finished typing
                    dialogueElement.textContent = text;
                    gameState.isTyping = false;
                    if (onComplete) onComplete();
                }
            }

            dialogueElement.textContent = '';
            type();

            // Click to complete typing
            document.addEventListener('click', function completeTyping() {
                if (gameState.isTyping) {
                    gameState.isTyping = false;
                    dialogueElement.textContent = text;
                    if (onComplete) onComplete();
                    document.removeEventListener('click', completeTyping);
                }
            });
        }

        // Previous functions remain the same
        function togglePause() {
            gameState.paused = !gameState.paused;
            document.querySelector('.pause-menu').classList.toggle('active');
        }

        function returnToTitle() {
            document.getElementById('game-interface').classList.remove('active');
            document.getElementById('start-screen').classList.add('active');
            document.querySelector('.pause-menu').classList.remove('active');
        }

        function showChoices(choices, resolve) {
            const choicesContainer = document.querySelector('.choices');
            choicesContainer.innerHTML = '';
            choicesContainer.classList.add('active');

            choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.textContent = choice;
                button.onclick = () => {
                    choicesContainer.classList.remove('active');
                    resolve(index);
                };
                choicesContainer.appendChild(button);
            });
        }
    </script>
</body>
</html>
